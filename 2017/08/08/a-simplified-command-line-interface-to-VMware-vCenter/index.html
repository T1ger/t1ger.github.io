	<!DOCTYPE HTML>
<html>
<head>
  <meta charset="utf-8">
  <meta name="google-site-verification" content="B6QNJ8N2Q7hbnMncyrM5GMCWgK-vIAEx0o2DQre64ls" />
  
  <title>a simplified command-line interface to VMware vCenter | t1ger的茶馆</title>
  <meta name="author" content="t1ger">
  
  <meta name="description" content="https://t1ger.github.io/">
  

  
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  
  <meta property="og:title" content="a simplified command-line interface to VMware vCenter"/>
  <meta property="og:site_name" content="t1ger的茶馆"/>

  
  
		<!-- favicon -->
		<link rel="apple-touch-icon" sizes="57x57" href="/apple-touch-icon-57x57.png">
		<link rel="apple-touch-icon" sizes="60x60" href="/apple-touch-icon-60x60.png">
		<link rel="apple-touch-icon" sizes="72x72" href="/apple-touch-icon-72x72.png">
		<link rel="apple-touch-icon" sizes="76x76" href="/apple-touch-icon-76x76.png">
		<link rel="apple-touch-icon" sizes="114x114" href="/apple-touch-icon-114x114.png">
		<link rel="apple-touch-icon" sizes="120x120" href="/apple-touch-icon-120x120.png">
		<link rel="apple-touch-icon" sizes="144x144" href="/apple-touch-icon-144x144.png">
		<link rel="apple-touch-icon" sizes="152x152" href="/apple-touch-icon-152x152.png">
		<link rel="icon" type="image/png" href="/favicon-32x32.png" sizes="32x32">
		<link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96">
		<link rel="icon" type="image/png" href="/favicon-16x16.png" sizes="16x16">
		<link rel="manifest" href="/manifest.json">
		<meta name="msapplication-TileColor" content="#009688">
		<meta name="msapplication-TileImage" content="/mstile-144x144.png">
		<meta name="theme-color" content="#009688">
		<!-- favicon end -->
    <!-- <link href="/favicon.ico" rel="icon"> -->
  

  <!-- toc -->
  <link rel="stylesheet" href="/libs/tocify/jquery.tocify.css" media="screen" type="text/css">

  <!-- <link rel="stylesheet" href="/libs/bs/css/bootstrap.min.css" media="screen" type="text/css"> -->
  <link rel="stylesheet" href="//apps.bdimg.com/libs/bootstrap/3.3.4/css/bootstrap.min.css" media="screen" type="text/css">

  <!-- material design -->
	<!-- <link rel="stylesheet" href="/libs/bs-material/css/ripples.min.css" media="screen" type="text/css"> -->
  <link rel="stylesheet" href="//apps.bdimg.com/libs/bootstrap-material/0.3.0/css/ripples.min.css" media="screen" type="text/css">
  <!-- <link rel="stylesheet" href="/libs/bs-material/css/material.min.css" media="screen" type="text/css"> -->
	<link rel="stylesheet" href="//apps.bdimg.com/libs/bootstrap-material/0.3.0/css/material.min.css" media="screen" type="text/css">

  <link rel="stylesheet" href="/css/highlight.light.css" media="screen" type="text/css">

  <link rel="stylesheet" href="/css/style.css" media="screen" type="text/css">

  

  

  <script src="//apps.bdimg.com/libs/jquery/2.0.3/jquery.min.js"></script>
	<script>window.jQuery || document.write('<script src="/libs/jquery-2.0.3.min.js" type="text/javascript"><\/script>')</script>

</head>

 	<body>
	  <nav class="navbar navbar-default">
    <div class="container">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">菜单</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="/">t1ger的茶馆</a>
        </div>
        <div id="navbar" class="collapse navbar-collapse">
            <ul class="nav navbar-nav navbar-right">
                
                <li>
                    <a href="/" title="">
                    <i class="fa fa-home"></i>首页
                    </a>
                </li>
                
                <li>
                    <a href="/archives" title="">
                    <i class="fa fa-list"></i>存档
                    </a>
                </li>
                
                <li>
                    <a href="/about" title="">
                    <i class="fa fa-info-circle"></i>关于
                    </a>
                </li>
                
                <li>
                    <a href="/atom.xml" title="这是一个订阅源">
                    <i class="fa fa-rss"></i>RSS
                    </a>
                </li>
                
            </ul>
        </div>
    </div>
</nav>

	  <div class="container" >
	    <div class="row">
	
	<div class="col-md-9 center-content">
	

		<div class="content">
			<!-- index -->
		   

			  		<h2>a simplified command-line interface to VMware vCenter</h2>
					
					<div>
						<span class="post-time">2017-08-08 15:38:20</span>
					</div>	
					

					<div class="article-content">
						<p>govc allows you to interface with VMware vCenter without the need for the dreaded vClient,Windows machines or to write you own scripts to access the horrible VMware API. This way you can easily automate many tasks on VMware directly from the command line or your bash scripts</p>
<p>by the way ,I don’t like interface with ESX/vCenter,this is so cool tools what I desired</p>
<p>First thing,you can compile it yourself, but there’s  handly binaries already available on the project github page <a href="https://github.com/vmware/govmomi/releases" target="_blank" rel="external">here</a></p>
<p>I downloaded it and created a small wrapper for it:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"># curl -LO https://github.com/vmware/govmomi/releases/download/v0.15.0/govc_linux_amd64.gz</div><div class="line"># gunzip govc_linux_amd64.gz</div><div class="line"># cat &gt;govc &lt;&lt;EOF</div><div class="line">#!/bin/bash</div><div class="line"> </div><div class="line">export GOVC_URL=&apos;https://username:password@vsphere-ip-or-hostname/sdk&apos;</div><div class="line">export GOVC_DATACENTER=VSPHERE_DC</div><div class="line">export GOVC_INSECURE=true</div><div class="line"> </div><div class="line">/usr/bin/govc_linux_amd64 \$@</div><div class="line">EOF</div><div class="line"># chmod +x govc*</div><div class="line"># cp -i govc* /usr/bin/</div></pre></td></tr></table></figure></p>
<p>Note that you only need GOVC_INSECURE=true if you are using self-signed certificates and you don’t have CA added to you local trusted certs.</p>
<p>For a start,you can get some basic info about you environment:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line">[root@localhost daily]# ./govc about</div><div class="line">Name:         VMware vCenter Server</div><div class="line">Vendor:       VMware, Inc.</div><div class="line">Version:      5.1.0</div><div class="line">Build:        880146</div><div class="line">OS type:      win32-x64</div><div class="line">API type:     VirtualCenter</div><div class="line">API version:  5.1</div><div class="line">Product ID:   vpx</div><div class="line">UUID:         4AC51BFC-DC4E-47D3-A912-B51A1A28BAFA</div><div class="line"></div><div class="line">[root@localhost daily]# ./govc datacenter.info</div><div class="line">Name:                ws_dc01</div><div class="line">  Path:              /ws_dc01</div><div class="line">  Hosts:             5</div><div class="line">  Clusters:          0</div><div class="line">  Virtual Machines:  69</div><div class="line">  Networks:          3</div><div class="line">  Datastores:        10</div><div class="line">Name:                ws_dc02</div><div class="line">  Path:              /ws_dc02</div><div class="line">  Hosts:             5</div><div class="line">  Clusters:          0</div><div class="line">  Virtual Machines:  118</div><div class="line">  Networks:          32</div><div class="line">  Datastores:        5</div></pre></td></tr></table></figure></p>
<p>if you want to get usage about govc,just run govc without any argument. To see what parameters a command supports, run govc command –help </p>
<p>eg,you can easily get some info with one simple command:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div></pre></td><td class="code"><pre><div class="line">[root@localhost daily]# ./govc datastore.info </div><div class="line">Name:        datastore21</div><div class="line">  Path:      /ws_dc01/datastore/datastore21</div><div class="line">  Type:      VMFS</div><div class="line">  URL:       ds:///vmfs/volumes/522460d8-f202b496-a69f-90b11c2afe3d/</div><div class="line">  Capacity:  2508.2 GB</div><div class="line">  Free:      470.2 GB</div><div class="line">Name:        datastore20</div><div class="line">  Path:      /ws_dc02/datastore/datastore20</div><div class="line">  Type:      VMFS</div><div class="line">  URL:       ds:///vmfs/volumes/52778cbb-107633af-7209-90b11c2a9f0f/</div><div class="line">  Capacity:  2508.2 GB</div><div class="line">  Free:      176.5 GB</div><div class="line">  </div><div class="line">[root@localhost daily]# ./govc host.info</div><div class="line">/usr/bin/govc_linux_amd64: default host resolves to multiple instances, please specify</div><div class="line">[root@localhost daily]# ./govc host.info -host.ip=192.168.1.20</div><div class="line">Name:              192.168.1.20</div><div class="line">  Path:            /ws_dc01/host/192.168.1.20/192.168.1.20</div><div class="line">  Manufacturer:    Dell Inc.</div><div class="line">  Logical CPUs:    32 CPUs @ 2599MHz</div><div class="line">  Processor type:  Intel(R) Xeon(R) CPU E5-2670 0 @ 2.60GHz</div><div class="line">  CPU usage:       2703 MHz (3.3%)</div><div class="line">  Memory:          130976MB</div><div class="line">  Memory usage:    92697 MB (-1.2%)</div><div class="line">  Boot time:       2017-06-26 11:09:53.406999 +0000 UTC</div><div class="line"></div><div class="line">  </div><div class="line">[root@localhost daily]# ./govc vm.info  -vm.ip=192.168.1.180</div><div class="line">Name:           ws-180</div><div class="line">  Path:         /ws_dc01/vm/ws-180</div><div class="line">  UUID:         4232a9b7-a1de-e45b-453b-beade5b7935a</div><div class="line">  Guest name:   CentOS 4/5/6 (64-bit)</div><div class="line">  Memory:       4096MB</div><div class="line">  CPU:          8 vCPU(s)</div><div class="line">  Power state:  poweredOn</div><div class="line">  Boot time:    2017-06-26 11:34:54.042422 +0000 UTC</div><div class="line">  IP address:   192.168.1.180</div><div class="line">  Host:         192.168.1.20</div></pre></td></tr></table></figure></p>
<p>If you want to look someting , it good way to use ls command<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line">[root@localhost daily]# ./govc ls</div><div class="line">/ws_dc01/vm</div><div class="line">/ws_dc01/network</div><div class="line">/ws_dc01/host</div><div class="line">/ws_dc01/datastore</div><div class="line">[root@localhost daily]# ./govc ls /ws_dc01/vm</div><div class="line">/ws_dc01/vm/elk149</div><div class="line">/ws_dc01/vm/elk148</div><div class="line">/ws_dc01/vm/elk147</div><div class="line">...</div><div class="line"></div><div class="line">[root@localhost daily]# ./govc ls /ws_dc01/host</div><div class="line">/ws_dc01/host/192.168.1.20</div><div class="line">/ws_dc01/host/192.168.1.21</div><div class="line">...</div><div class="line"></div><div class="line">[root@localhost daily]# ./govc ls /ws_dc01/datastore</div><div class="line">/ws_dc01/datastore/datastore21</div><div class="line">/ws_dc01/datastore/datastore20</div><div class="line">...</div></pre></td></tr></table></figure></p>
<p>govc also allow you to run esxcli on the specified host, for example in one of my many experiments I ran:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">[root@localhost daily]# ./govc host.esxcli  --host.ip=172.16.56.20 vm process list|grep DisplayName | awk &#123;&apos;print $2&apos;&#125; | sort</div><div class="line">debug140</div><div class="line">debug141</div><div class="line">debug142</div><div class="line">elk147</div><div class="line">elk148</div><div class="line">elk149</div><div class="line">...</div></pre></td></tr></table></figure></p>
<p>A very import thing to notice is that every command can be run with the parameters -json=true.This output a machine-parsable format that includes many more details than the normal text output.<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div></pre></td><td class="code"><pre><div class="line">[root@localhost daily]# ./govc ls -json /ws_dc01/datastore/datastore20|python -m json.tool</div><div class="line">&#123;</div><div class="line">    &quot;DeRef&quot;: false,</div><div class="line">    &quot;Dump&quot;: false,</div><div class="line">    &quot;JSON&quot;: true,</div><div class="line">    &quot;Long&quot;: false,</div><div class="line">    &quot;Out&quot;: &#123;&#125;,</div><div class="line">    &quot;TTY&quot;: false,</div><div class="line">    &quot;ToRef&quot;: false,</div><div class="line">    &quot;Type&quot;: &quot;&quot;,</div><div class="line">    &quot;elements&quot;: [</div><div class="line">        &#123;</div><div class="line">            &quot;Object&quot;: &#123;</div><div class="line">                &quot;AlarmActionsEnabled&quot;: true,</div><div class="line">                &quot;AvailableField&quot;: null,</div><div class="line">                &quot;Browser&quot;: &#123;</div><div class="line">                    &quot;Type&quot;: &quot;HostDatastoreBrowser&quot;,</div><div class="line">                    &quot;Value&quot;: &quot;datastoreBrowser-datastore-514&quot;</div><div class="line">                &#125;,</div><div class="line">                &quot;Capability&quot;: &#123;</div><div class="line">                    &quot;DirectoryHierarchySupported&quot;: true,</div><div class="line">                    &quot;NativeSnapshotSupported&quot;: false,</div><div class="line">                    &quot;PerFileThinProvisioningSupported&quot;: true,</div><div class="line">                    &quot;RawDiskMappingsSupported&quot;: true,</div><div class="line">                    &quot;SeSparseSupported&quot;: null,</div><div class="line">                    &quot;StorageIORMSupported&quot;: true,</div><div class="line">                    &quot;TopLevelDirectoryCreateSupported&quot;: null,</div><div class="line">                    &quot;UpitSupported&quot;: null,</div><div class="line">                    &quot;VmfsSparseSupported&quot;: null,</div><div class="line">                    &quot;VsanSparseSupported&quot;: null</div><div class="line">                &#125;,</div><div class="line">[...]</div></pre></td></tr></table></figure></p>
<p>of course,could be very handy for your scripts!</p>
<p>ref<br><a href="http://www.virtuallyghetto.com/2014/09/govmomi-vsphere-sdk-for-go-govc-cli-kubernetes-on-vsphere-part-1.html" target="_blank" rel="external">govmomi (vSphere SDK for Go), govc CLI &amp; Kubernetes on vSphere</a><br><a href="https://velenux.wordpress.com/2016/09/19/automate-your-vcenter-interactions-from-the-linux-commandline-with-govmomi-and-govc/" target="_blank" rel="external">Automate your vCenter interactions from the Linux commandline with govmomi and govc</a><br><a href="https://dellaert.org/2013/03/04/pysphere-script-to-clone-a-template-into-multiple-vms-with-post-processing/" target="_blank" rel="external">PySphere script to clone a template into multiple VMs with post processing</a><br><a href="https://github.com/tkak/terraform-provider-vsphere" target="_blank" rel="external">terraform-provider-vsphere</a></p>
<hr>
<p>您的鼓励是我写作最大的动力</p>
<p>俗话说，投资效率是最好的投资。 如果您感觉我的文章质量不错，读后收获很大，预计能为您提高 10% 的工作效率，不妨小额捐助我一下，让我有动力继续写出更多好文章。</p>

							<!-- 支付宝打赏图案 -->
      						<div id="donate_guide" class="donate_bar center ">
          					<a href="http://mypay-1253516637.costj.myqcloud.com/2000.jpg" title="支付宝打赏" class="fancybox" rel="article0"       style="float:left;margin-left:25%;margin-right:2px;">
          					<img src="http://mypay-1253516637.costj.myqcloud.com/2000.jpg" title="支付宝打赏" height="164px" width="164px">
          					</a> 
      						</div>
					</div>

			  <!-- about -->
			  
		</div>

		<!-- pagination -->
	  

		<div class="comment-section">
  
  


</div>
	</div>

	

</div>


		<footer>
			


<p>
  由 <a href="https://hexo.io">hexo</a> 强力驱动 |&nbsp;&nbsp;本站总点击 <span id="busuanzi_value_site_pv"></span> 次
&nbsp;&nbsp;|&nbsp;&nbsp;您是第 <span id="busuanzi_value_site_uv"></span> 位访客
</p>
<p>
  &copy; 2018 <a href="https://t1ger.github.io"> t1ger </a>
  &nbsp;&nbsp;|&nbsp;&nbsp;<span><a href="/baidusitemap.xml">百度网站地图</a></span>

</p>

<script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js">
</script>

<script>
(function(){
    var bp = document.createElement('script');
    bp.src = '//push.zhanzhang.baidu.com/push.js';
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
})();
</script>

<a id="gotop" href="#" title="back to top"><i class="mdi-hardware-keyboard-arrow-up"></i></a>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-99921399-1', 'auto');
  ga('send', 'pageview');

</script>
		</footer>
	  </div>

		<!-- <script src="/libs/bs/js/bootstrap.min.js"></script> -->
		<script src="//apps.bdimg.com/libs/bootstrap/3.3.4/js/bootstrap.min.js"></script>
		<script>(typeof $().modal == 'function')|| document.write('<script src="/libs/bs/js/bootstrap.min.js" type="text/javascript"><\/script>')</script>

		<!-- material design -->
		<!-- <script src="/libs/bs-material/js/ripples.min.js"></script> -->
		<script src="//apps.bdimg.com/libs/bootstrap-material/0.3.0/js/ripples.min.js"></script>
		<!-- <script src="/libs/bs-material/js/material.min.js"></script> -->
		<script src="//apps.bdimg.com/libs/bootstrap-material/0.3.0/js/material.min.js"></script>
		<!-- toc -->
		<!-- <script src="/libs/tocify/jquery-ui.min.js"></script> -->
		<script src="//apps.bdimg.com/libs/jqueryui/1.10.4/jquery-ui.min.js"></script>
		<script src="/libs/tocify/jquery.tocify.custom.js"></script>

		<script src="/js/main.js"></script>

	</body>
</html>
